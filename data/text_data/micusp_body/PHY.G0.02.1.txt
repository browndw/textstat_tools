Chemistry is intrinsically concerned with the structure of molecules and the reactivity of molecular systems. One of the principal concerns of chemistry is to find the energetically accessible confirmations and/or equilibrium structure of a given chemical system.
In general, the potential energy surface (PES) of a molecule is a 3N-6 dimensional surface, where the coordinates are the 3N-6 internal coordinates obtained when translational and rotational degrees of freedom are annihilated. In theory, one can calculate the PES for any system by solving the time-independent electronic Schrodinger equation for every possible position of every atom, however, such ab initio calculations are too expensive to be considered.
Many force fields used in practice today are empirical force fields (AMBER, CHARMM, etc.) that can model the PES of a large variety of chemical systems. Such empirical force fields are based on theory, experiment, and also intuition. Therefore, in practice, the PES is almost always defined through the choice of an empirical force field that describes the inter-atomic interactions in a molecule. This is basically choosing the "correct" functional form and the parameters which combined, will describe all inter-atomic interactions.
In considering chemical systems, the PES is a 3N-6 multidimensional function. From basic multivariable calculus, one knows that at a minimum, the first derivative of the potential with respect to each individual variable vanishes (that is) and that the second derivative of the potential with respect to each variable must be greater than zero. For a chemical system, finding the minima on the PES corresponds to finding the stable points of the system and thus, finding the geometry of the molecular system. Finding the global minimum corresponds to finding the conformation of a system with the least energy, the equilibrium conformation. Transition states that connect minima on the PES are defined as saddle points, that is a point on the PES where the PES is at a maximum with respect to one coordinate and a minimum with respect to all other coordinates. The transition mode, which will describe the motion in going from one minimum to the next, is described by the single coordinate that is at a maximum at the saddle point.
In this laboratory exercise, we will focus on the Newton-Raphson method and steepest descent methods to find minima of a potential energy surface. Both of these methods are based on the Taylor expansion of the PES:
Note that the Newton-Raphson method, which uses up to second derivative information, assumes that the PES is a harmonic potential. For a simple quadratic function, the Newton-Raphson method can find the minimum in one step, but for more complex systems, it will take several iterations. For the Taylor expansion above, the first derivative of V(x) is:
If the function is purely quadratic, which is assumed in a harmonic potential, the second derivative is the same everywhere, that is:
At the minimum point x=x*:
Therfore the minimum point is:
This can be extended to a chemical system if one makes each variable x and V a matrix of 3N-dimensions, where N is the number of atoms in the system and V is defined by some empirical or ab initio force field.
Note that this is computationally expensive since it requires inversion of the Hessian matrix. Therefore, in most quantum chemistry programs (Gaussian, Q-Chem, Jaguar), quasi-Newton-Raphson steps are used to find a minimum.
In exploration 1, we will be using the steepest descents method which uses only first derivative information to find a minimum of a PES. In this method, the "ball" on the potential energy surface will move in the direction exactly parallel to the net force. For 3N coordinates, this direction is conveniently represented by the negative of the unit vector of the gradient of the PES, that is:
The step size that one takes in moving along this PES is defined in the programs that we use in this exploration.
The function given to our group was:
A contour plot and a surface plot of this function are shown below:
Note that there are two local minima on this surface.
For this exploration, we tried using several step sizes, initial positions and tolerances. Below are the results of these explorations. First consider changing only the initial guess:
Note: For these trials, the tolerance was held constant at 0.0001 and step size was held constant at 0.001.
When the initial guess was changed and all other parameters such as step size and tolerance were held constant, we see that the minimum that is found in a given optimization is dependent on the initial guess. This is because the steepest descent will always tend to push the "ball" on the PES in the direction of the steepest negative slope. Therefore, sometimes it will push it all the way to the global minimum and sometimes it will push it to the local minimum. Once the "ball" reaches any minimum point on the surface, it is no longer subject to a force since the gradient of the potential is zero at any minimum.
Below are plots of minimization tracks for various initial guesses:
Consider changing the tolerance:
When the tolerance was changed and all other parameters such as initial guess and step size were held constant, we tended to arrive near the same minimum point, but not exactly. The tolerance indicates the maximum value for which a gradient is considered zero by the algorithm. Thus, for a larger tolerance, there is a larger space around the exact minimum point which will be considered to have a gradient of zero. We see that at low tolerances such as 0.0001, we reach a fairly accurate point but as we increase the tolerance by orders of magnitude, the minimum tends to shift away from this point. Once the "ball" reaches the cusp of the space where the gradient is considered zero, it will stop because there is no force acting on the ball. Thus, at higher tolerances, we will actually reach a less accurate minimum point. In order to have acceptable values, the tolerance should be less than or equal to 0.0001, however, one should always try to use the lowest tolerance possible to attain accurate results.
Consider changing the step size:
When the step size was changed, we tended to find drastically different minima. When the step size was increased by one order of magnitude from 0.001 to 0.01, the minimum point found differs slightly. When the step size is too large, such that moving along the steepest gradient with a given step size will move to a point that is not defined by the function (f(x,y)=0), the steepest descent method essentially stops. This is because moving to a point that is not defined by the surface then has a value of f(x,y)=0, which has a derivative with respect to all coordinates which is also zero. Thus, no further movements will be made toward a minimum. When the step size is increased by two orders of magnitude from 0.001 to 0.1, we find that the large step size causes the steepest descent vector to move to an "undefined" point very quickly in the minimization routine. This is why the minimum point found is so drastically different compared to the results for the other two step sizes. In order to be accurate, one should use a step size which is less than or equal to 0.01 for qualitative results which are accurate to the tenths place. However, to get quantitative results, the step size should be less than or equal to 0.001.
Note that in the above exploration, we have located all minima of the surface that is described by the function
For exploration 2, we will be using the Lennard-Jones 12-6 potential to model the van der Waals interactions which hold the two and three atom clusters together which we will be studying. The Lennard-Jones 12-6 potential is of the form:
This potential is empirical and has been derived from experiment, but it has firm theortical grounding. It is important to note that the Lennard-Jones 12-6 potential only models pairwise interactions, however, for many systems, this proves to be a fairly good approximation. The first term,
For explorations two through four, we will be using the following parameters given to our group:
For exploration 2a, we produced a contour plot and a surface plot of the constant angle potential for the three atom van der Waals molecule, Ar-Kr-Ar. This constant angle potential corresponds to the angle indicated being held constant and the other two internal coordinates, r1 and r2, are free to vary.
Below is the equation which is used to calculate the LJ-potential in the polar coordinates which will make it easy to develop a constant angle potential.
Below is the surface plot and contour plot of the constant angle Lennard-Jones 12-6 potential when the angle θ is held constant at 70.777° as calculated by Mathcad after geometry optimization in Cartesian coordinates. Below is the calculated cluster geometry after energy has been minimized.
Note that we reach a minimum at a certain distance, but that at inter-atomic distances closer than the equilibrium distance, the potential goes to infinity, representing the repulsion of the atoms at close distances. This is modeled by the (1/r)12 part of the potential. Also note that the potential is symmetrical since the pairwise interactions between krypton and each of the two argons are exactly the same. Also, at distances which are greater than the equilibrium distance, the potential rises up out of the minimum (modeled by (1/r)6 part of LJ potential), but at a slower rate than when the inter-atomic distances are less than the equilibrium distance.
For exploration 2b, we set out to construct a Lennard-Jones 12-6 potential for the van der Waals cluster Ar-Kr-Ar where the bond length between the two argon atoms remains constant while the other two parameters vary. For this case, it will be easier to use Cartesian coordinates to construct the potential.
Note that when the interactions are between Kr and Ar, we take the averages of the ε and σ parameters of the two atoms to describe the interactions. When it is the Ar-Ar interaction, we only use the ε and σ values for argon to describe the pairwise interaction. Using this information, we calculate the Lennard-Jones potential for the Ar-Kr-Ar van der Waals cluster when the Ar-Ar bond length is held constant:
Where x1 is the distance from the argon to argon along y=0, y2 is the y-axis projection of the vector connecting the Ar atom to the Kr atom, and x2 is the x-axis projection of the vector connecting the Ar atom to the Kr atom. Also note that as stated above, ε12 and σ12 are defined as:
Mathcad minimizes this Lennard-Jones potential to give an equilibrium geometry. The equilibrium geometry is as pictured below with the coordinates indicated:
Below is a surface plot of the Lennard-Jones potential where the Ar-Ar bond length is held constant at 406.672pm as determined by the Mathcad minimize function. Note that the minimum energy state has energy of-3.148*103 J/mol.
Note that in this plot, there are two global minima, but several local minima which kind of surround the global minima. There are two global minima due to the inherent symmetry of the system. That is to say that the values of r2 and r3 in figure 9 may exchange such that r2=______and r3=_________. Therefore, we reach a symmetrically equivalent molecule with the same energy. Also note that at distance closer than the minima (local or global), the potential tends to infinity as expected. This of course is dictated by the repulsive nature of atoms at close distances which is governed by the (1/r)12 term in the LJ potential. Also note that the global minima has energy which correspond to the calculated minimum energy above. As the atoms move farther away, that is, when interatomic distances become large in either direction, the energy increases with respect to the minima, but not nearly as fast as when the interatomic distances become very small. This is because as the atoms move far apart, they are largely governed by the (1/r)6 term rather than the (1/r)12 term.
In exploration 3, we constructed a program to perform a steepest descent minimization of the van der Waals cluster consisting of Ar-Kr-Ar. The potential is still described by the Lennard-Jones 12-6 potential, but this time, no parameters are held fixed as in exploration 2. We have calculated the equilibrium geometry and energy of the van der Waals cluster for five different initial starting geometries to test the robustness of this steepest descent minimization. Below is a table summarizing our results. The program which was used to run the steepst descent algorithm is attached in the appendix.
From these results, it appears that the steepest descent minimization routine is not robust as it tends to lead us to different equilibrium geometries based on the initial guess. For the fourth trial where the initial guess has all the atoms aligned in the x1-x2 plane, it converges to another geometry which is also planar. Since y2=0, the first derivative of V(x1,x2,y2) with respect to y2 is always zero. This implies that the force in the y2-direction is always zero, therefore, the atoms will never be pushed out of the x1-x2 plane. For the last guess, which involves an initial guess where the atoms are absurdly far apart, it appears that the geometry only shifts in the x1 direction. This indicates that at very far distances for x2 and y2, the potential has the following characeteristics:
However, it appears that the steepest descents method takes us to the correct place for x1, which indicates that there is a significant gradient with respect to x1 at x1=1000 to push us down into the minimum.
In exploration 4, we will be looking at a van der Waals cluster of Ar5Kr whose minimization is governed by the minimization routine in Mathcad. According to valence shell electron pair repulsion theory (VSEPR), the equilibrium geometry of such a 6 atom cluster should be a trigonal bipyramid. For the first few starting geometries, we chose the trigonal bipyramid geometry to be sure that nothing was incredible wrong with the minimization routine. Below is a summary of our results, which includes starting geometries, bond lengths between all Ar-Kr atoms and energy at equilibrium geometry.
Starting geometry given in Cartesian coordinates (x,y,z) for each atom. Note the the last row is the krypton atom, while the other rows represent the argon atoms. The diagram to the right indicates graphically what the q matrix looks like in space.
Starting initial geometry is given in the same matrix as in trial 1 and a diagram is included once again to indicate graphically what the q matrix looks like in space.
Starting initial geometry is given in the same matrix as in trial 1 and a diagram is included once again to indicate graphically what the q matrix looks like in space.
This time we start with all the atoms in a plane. Starting initial geometry is given in the same matrix as in trial 1 and a diagram is included once again to indicate graphically what the q matrix looks like in space.
According to our results, we have found four different energy minima which indicates that this energy minimization routine is not robust. Furthermore, each initial guess appears to converge to a different geometry, most notably the case where the atoms all start in a plane (trial 4). It appears that this minimization routine must somehow use a steepest descent method because the optimized geometry also has a planar geometry. As discussed before, if the z-component of every atom is always zero, then the partial derivative of the potential with respect to z will always be zero, which indicates that there is no force to push the atoms out of the z=0 plane.
Below is a figure comparing the energies of the various confirmations of the local and global minima that were located. It appears that the first equilibrium confirmation is the global minimum and according to chemical intuition, this should be the global minimum since six atom clusters should tend to a trigonal bipyramidal structure.
In this exploration, we will be using the Lennard-Jones potential to calculate vibrational frequencies of a Ar-Kr-Ar cluster (part a) and a Kr-Ar-Kr cluster (part b). To calculate the vibrational frequencies, we expand the potential in a Taylor series and eliminate all anharmonic terms so that we work in the harmonic approximation:
We choose V(0)=0 out of convenience and note that at local minima, the second term will vanish. Thus, we are left with a potential of the form:
If we use Hooke's law to describe the restoring force, then this potential becomes:
Now we can describe this motion by Newton's second law:
This is a second order linear differential equation which may be easily solved, however, it is not done here. For more complex systems involving more degrees of freedom, the challenge of calculating vibrational modes is rather complicated because the relation between the PES and the vibrations is inherently more complex. Note that for a system of N particles, there are 3N-6 vibrational degrees of freedom since there will be 3 rotational degrees of freedom and 3 translational degrees of freedom.
We may derive the equation of motion for this system which involves taking the 3N coupled differential equations in Cartesian coordinates and doing a unity transform to the 3N-uncoupled differential equations of the normal modes. By following this procedure, each vibrational spatial coordinate, qi is described by the following differential equation:
The solution to this differential equation yields:
Therefore, one may reconstruct the differential equation above as:
And this may be written in terms of matrices and vectors which will give us a "prescription" to find its result:
The non-trivial solution of this equation occurs when the coordinates qi are not zero. Thus, the normal mode motions are described by the eigenvectors of B, also known as the mass-weighted Hessian or mass-weighted "force constant" matrix. Its eigenvalues will give us the corresponding vibrational frequencies for each vibrational motion.
The vibrational coordinates of the Ar-Kr-Ar cluster and the Kr-Ar-Kr cluster differ slightly. This is due to the increased weight of the Kr atoms with respect to the Ar atoms. By having a heavier system, this will slow down the vibrations, as seen by the reduced frequencies in part b of this exploration. Thus, one witnesses that the eigenvalues of the Hessian matrix are larger in part b where the mass weighting slows down the vibrations since having two Kr's versus two Ar's will slow down the vibration.
In exploration 6, we use Spartan '04 (Windows edition) to explore the robustness of various molecular mechanics force fields, especially the Merck Molecular Force Field (MMFF). In this exploration, we will be running experiments on hydroxyamphetamine (a derivative of methamphetamine, a popular street drug):
In this exploration, we will try different starting geometries to see if using the molecular mechanics method with the MMFF parameters finds the same minimum. The starting geometries were varied by rotating around the single bonds in the floppy alkyl group of the molecule. Below is a summary of results and diagrams of the optimized geometries for trials 1 and 3:
It should be noted that the optimized molecular geometry of trial 3 differed greatly from the optimized molecular geometries of trials 1 and 2, whose optimized geometries looked relatively similar.
The calculated minimum energy confirmation is dependent upon the input of the geometry. This is because once the minimization routine finds any minimum, local or global, the gradient of the potential with respect to all coordinates is zero which implies that there is no force to push the structure toward a lower energy. Thus, for trials 1-2, the minimization routine found a different minimum point on the PES than for trial 3.
For exploration 6b, we used a Monte Carlo search method to find the conformational distribution of our molecule in a particular starting geometry. We used the input geometry for trial 3 as our initial guess.
This Monte Carlo algorithm employed here does a Monte Carlo search with a path that biases low energy conformers. Although we might not find the global minimum, Spartan finds the conformers that one keeps constitutes a Boltzmann distribution.1
For the given starting geometry, the Monte Carlo conformational search found 18 different minima. The lowest energy confirmation has an energy of 17.3791 Hartrees and its geometry is plotted below.
In exploration 6c, we rotated around one of the flexible bonds in our molecule to develop an energy profile for rotation about this bond. Below is an image of the molecule which indicates the bond about which the molecule rotated and the confirmation that corresponds to the zero degree mark.
For this exploration, we have used two different force fields, MMFF and SYBYL, to calculate an energy profile. Below are plots of the results:
The results of this exploration indicate that using different force fields will give different results. This is because different force fields correspond to different functionals which may have been subject to different target sets. MMFF has been "specifically parameterized to reproduce geometries and conformations of organic molecules and biomolecules" while SYBYL is parameterized for the entire periodic table.
Below are hand-drawn sketches of three vibrational modes of hydroxyamphetamine in its minimum energy state found in part c. All of these vibrations will be seen in the IR spectrum (which is plotted below). This is because the overall dipole moment of the molecule changes upon excitations at these specific frequencies.
