Driver modeling is an essential part in studies on closed-loop human/vehicle/road systems. However, it is a challenging task to model human drivers not only because there are no equations or theories that fully describe the complex human cognitive process, but also because drivers adapt themselves to different driving and traffic situations, thereby constantly changing their strategies and characteristics. Although driver behavior is in general complicated, lane keeping is a relatively straightforward driving control task. Even drivers without much training are able to maintain lane position and maneuver when following twisting roadways.
Driver directional control models have been developed based on different philosophies and approaches, and detailed reviews can be found in MacAdam [1] and Ploechl et al. [2]. As suggested by McRuer [3], the driver directional control actions could be separated into three types: compensatory, pursuit and precognitive (Figure 1). Compensatory control is carried out in a closed loop. The driver is assumed to utilize feedback loops based on the position error and the heading angle with respect to road tangent to minimize undesired deviations. Pursuit control operates by using the driver's preview of the upcoming road path and initiating feedforward control actions. Precognitive control usually plays a role only for repetitive well-learned tasks such as pull-in maneuvers in a parking lot, and thus can be ignored in daily highway driving.
Among the existing driver lateral control models, the model developed by the University of Toronto [4] was composed of three components: curvature preview, heading angle feedback, and position feedback. It was assumed that the three components were sampled, possibly at different rates, and combined to generate the desired steering angle. At least five parameters needed to be specified. This model was applied to both lane keeping and lane change maneuvers. The STI (Systems Technology Incorporation) model detailed in [5] consisted of two parts: the motion feedback from vehicle yaw rate and the visual feedback from curvature error. The elaborate curvature error term included the contributions from lateral offset, heading angle error, projected future vehicle position, and aim point position on curved road. An extra "trim" term in integral controller was added to eliminate steady-state error. In combination, they were used to generate a desired steering wheel velocity. In the "structural model" developed by Hess et al. [6], the driver was represented by a low-frequency compensator and a high-frequency compensation block, which included driver time-delay, "proprioceptive" feedback, and a second-order model of the neuromuscular system. The outer loop was closed using visual feedback based on an aim point error. Qualitatively, a reasonable match between model data and simulator test data was achieved. In the optimal preview model developed by MacAdam [7], the driver was assumed to behave like a preview optimal controller with time delay. A path error functional was constructed by previewing the road. The control objective was to minimize the weighted integral of squares of the differences between the previewed path points and the corresponding estimated lateral positions over the preview horizon.
Vehicle lateral control is a broad notion, which includes lane keeping, lane change, obstacle avoidance, stability control in critical situations, and so on. Among these maneuvers, lane keeping on normal highways belongs to low-bandwidth, low-acceleration plain tasks. The two primary sources of stimuli for lane keeping control are: (1) the desired path provided by the roadway markers, and (2) the perceived vehicle states. A skilled driver is expected to use feedforward control to respond directly to the effective future road inputs, as well as feedback control to respond to deviations from the desired states.
In both [4] and [5], separate gains or transfer functions were proposed to associate with lateral deviation, heading angle error, and the road curvature term. Their model parameters were calibrated with a limited driver subject group and reported in mean values and standard deviations. These values were direct results of model fitting and no clear internal relationship among them was revealed. The "structural model" [6] is formulated as a feedback structure, and it does not explicitly take the upcoming road curvature into account. The MacAdam model in [7] is proven versatile enough to fulfill tasks such as double lane change and slalom if tuned properly. However, as will be shown later, for a less complex task like lane keeping, by partitioning the control actions into feedforward/feedback components, a compact system structure can be formulated, and only two control parameters remain to be specified.
The system analysis starts with investigation of the plant dynamics in the next section, followed by the formulation of a control-oriented system structure. The determination of control parameters is detailed in the subsequent section. Then simulation studies are presented to validate the proposed model, and finally conclusions are drawn in the last section.
The dynamics of a passenger vehicle can be described by a detailed nonlinear model [8]. Under simplifying assumptions, the vehicle lateral motion can be decoupled from the longitudinal dynamics and characterized by a classic 2-degree of freedom (DOF) linearized model [9]. This planar "bicycle model" assumes a small road-wheel steering angle, retains only lateral and yaw dynamics, and is parameterized by a constant longitudinal velocity. Grouping the two front wheels and the two rear wheels separately, one obtains the single-track model illustrated in Figure 2. The variables and parameters are explained in the Appendix. Under normal highway driving conditions, it is justifiable to assume that the lateral force varies linearly with the tire slip angle. By applying the force and moment equilibrium conditions to the free body diagram and substituting the kinematic relationship of the tire slip angles, the equations of motion can be expressed in the state space form:
The sign convention conforms to the SAE coordinates system, and the angles are positive in the clockwise direction. This 2-DOF model is known to predict vehicle lateral behavior reasonably well when the lateral acceleration is below 0.3 g [10]. The analysis in subsequent sections is based on the parameters of a full-size sedan summarized in Table I.
Since the relative motion of the vehicle with respect to the road is of interest, additional variables need to be defined. Two coordinate systems have been introduced in Figure 2. The inertial system (X0, Y0) is fixed on the ground, which serves as a reference frame for vehicle motions. The body-fixed coordinate system is denoted by (x, y) with its origin located at the vehicle's center of gravity (CG). The CG lateral displacement YCG and the relative heading angle need to be added into the states. As in [11], the state-space equation can be written as
The front wheel steering angle Tf is the control input and the road curvature (since rd = u00) enters the system as an exogenous disturbance input. For steady-state lane following on a road with a constant curvature , one supposes the vehicle CG tracks the curve successfully. By setting and , the steady-state values of the relative heading angle and the front wheel steering angle can be derived
where Kus is the understeer coefficient. Both
Apart from the lateral position of vehicle CG, the lateral deviation Yp of a preview point (P) down the road is of interest as well (Figure 3), since the driver typically looks forward, extrapolates from current states and projects to an "aim point" a finite distance ahead [12]. Accordingly, given a preview distance Lp, the trigonometric relationship can be derived from the law of cosines.
The preview distance Lp along the vehicle's longitudinal axis can be replaced with the preview time Tp, namely
where
Evidently Yp consists of three terms, which arise from the local lateral deviation at the vehicle CG, relative heading angle, and curve bending, respectively. If the vehicle CG tracks the desired path successfully, Eq. (8) represents the previewed lateral deviation at steady state.
Hence Yp* is also proportional to road curvature, and the proportional constant is a function of vehicle parameters, longitudinal velocity, and preview distance. Consequently the complete state-space description can be expressed as a two-input-two-output system:
The control objective of lane keeping can thus be formulated as follows: to regulate lateral displacement YCG by assessing the previewed lateral deviation Yp and manipulating steering wheel angle input f to counteract road curvature disturbance . How a skilled human driver might process the perceptual cues and translate them into appropriate steering wheel angles, so that an adequate performance and stability margin can be achieved, is the topic of the following study.
A human driver's lane keeping control behavior can be divided into the open-loop pursuit and the closed-loop compensatory parts. The pursuit part previews the upcoming path and generates the primary portion of the steering action, whereas the compensatory part attenuates the remaining errors.
In the subsequent analysis, we assume that for lane keeping control, a driver only makes use of the estimated road curvature within the driver's preview distance, vehicle heading angle, and current lateral displacement from the reference position, which may be corrupted by noises or biased due to human perception limitations. The driver processes this set of information, follows the road curves, and stabilizes the vehicle. We also assume that the driver is a competent, but not necessarily perfect, lane keeping controller. Because in real life, most drivers manage to maintain lateral positions in spite of various disturbances, but few of them make every effort to stay at a single desired lateral position. Actually as long as sufficient stability margin and performance requirements are fulfilled, the resulting controller can be deemed a valid representation of drivers' control action.
Motivated by the pursuit/compensatory dichotomy, the proposed control structure is illustrated in Figure 4. The vehicle/road dynamics module is driven by the control input (u) and the disturbance input (d). The desired output (z) is the lateral displacement of the CG, and the measured output (y) is the lateral position at the preview point, which is corrupted by noise (n) then sensed by the driver as measured output (ym). The driver controller has three major elements: disturbance feedforward Gff, reference generation GR and feedback compensation Gfb. The driver controller also contains a multiplicative curvature estimation uncertainty (.) and an inherent human remnant term (nn) [13]. One additional degree of control freedom, Tp, is hidden in the vehicle/road dynamics module.
In actual driving, the driver looks ahead and perceives upcoming road geometry. The curvature disturbance can be anticipated and a feedforward compensator can be used to alleviate its effect preemptively, so that the driver turns the steering wheel based on his/her internal empirical model of the vehicle yaw dynamics [14]. The mathematical relationship for this curve negotiation behavior at steady state is expressed by Eq. (4). Essentially the driver tends to match the yaw rate of the vehicle with that of the road tangent. Therefore
For the reference generation, Eq. (8) is used to derive the desired lateral deviation of the preview point, therefore
If the road is straight, the reference lateral position stays at zero. However, if there exists a substantial road curvature, the reference position should be biased. The magnitude of the bias is dependent on vehicle parameters, the preview distance, and the curvature itself. Figure 5 shows how Gff and GR vary as a function of longitudinal velocity when other parameters and variables are fixed. For easier interpretation, the unit of the curvature is taken as 1/km, and the steering angle is computed at the steering wheel in degrees.
The feedforward loop partially inverts the vehicle dynamics so as to achieve faster response. Any remaining deviation needs to be taken care of by the compensatory loop. As an initial step, a basic feedback controller is assumed, which is composed of a pure proportional action along with human cognitive limitations:
In brief summary, a skilled driver is supposed to take advantage of knowledge about future disturbances and relies on feedforward and feedback actions to reject the disturbance, essentially reducing the norm of the closed-loop transfer function Tzd from the curvature input to the lateral displacement at CG. Given the proposed lane keeping control structure in Figure 4 and the above analysis, two control design parameters (Kp and Tp) remain to be determined to achieve satisfactory performances compatible with what drivers normally do.
To visualize the potential effects of driver's forward-looking, the Bode plots for the plant dynamics (from steering wheel angle lSW to the previewed lateral position Yp) are shown in Figure 6, with varying preview times. In general, a longer preview results in more substantial phase leads. However, a larger preview time does not necessarily lead to more substantial phase margin. The maximal phase margin occurs when Tp takes an intermediate value. Figure 7 presents the Bode plots for the open loop transfer function (GfbfGyu) with fixed preview time and varying feedback gains. Due to the human time delay, the phase plot has a much different pattern from that in Figure 6. It is evident that a low gain results in small phase margin and low cross-over frequency, whereas an improperly large gain reduces both gain margin and phase margin, thus undermining closed-loop stability. Therefore an appropriate range of feedback gain exists for achieving adequate performance and stability margin.
The selection of the control parameters Tp and Kp is conducted with an optimal search procedure. During the optimal search, it is not aimed to achieve the best feasible performance. Instead, as long as sufficient stability margin and performance requirements are met, the solution will be accepted.
Sufficient phase margin and gain margin are essential in order to avoid excessive steering oscillation and maintain stability. In an automatic steering system design [16], a 50-degree PM was obtained by optimization. In an earlier study [3] by McRuer et al., a PM of approximate 40 degrees was determined for compensatory driver steering control tasks. In the present optimal search procedure, constraints of a 40-degree PM and 3.2 dB GM will be imposed. In order to avoid lane straddling, maximal CG lateral displacement has to be lower than 0.9 m in response to a 0.25g lateral acceleration disturbance. According to the AASHTO Green Book [17], the minimum radius for freeway horizontal alignment generally results in lateral acceleration lower than 0.25g. The 0.9 m constraint is based on the 1.8 m nominal vehicle width and the prevailing 12 ft (3.66 m) highway lane width [18].
The objective of the optimal search is to obtain the minimal preview time and the associated gain that satisfy the above constraints. The assumption regarding the preview time is: the farther the driver has to look ahead, the noisier the measurement becomes and the more stringent the visibility condition is. So the driver settles for short previews as long as system performance is ensured.
The search procedure is implemented as follows. For every vehicle speed and for any given preview time, the optimal feedback gain is sought to minimize the infinity norm of the closed-loop transfer function Tzd, while satisfying all the constraints on PM, GM, and maximal CG lateral displacement. Then among the feasible solution pairs Tp and Kp, the smallest Tp and its associated Kp will be chosen. This process is repeated for a range of reasonable highway driving velocities and the resulting optimal parameter pairs are illustrated in Figure 8. Also shown is the equivalent optimal preview distance (further divided by 10).
An inspection of Figure 8 reveals the following observations. The optimal preview distance increases with the vehicle velocity. The optimal preview time has a slight downward trend, but overall falls into a narrow range (1.4 ~ 1.7 s) over normal highway travel speeds, which is consistent with the values reported in [19]. A large feedback gain is required at low vehicle speeds. Beyond 20 m/s (45 mph) the optimal control gain varies quite gently; its smoothness is expected to lead to consistent driver behavior as velocity changes.
Figure 9 shows the Bode plots for the open loop and closed-loop transfer functions after the optimal control parameters are specified (at u0 = 25 m/s). The open loop frequency response is in agreement with the Cross-over model [20]: around the gain cross-over region, the magnitude response can be approximated with a-20 dB/decade line. The right panels show that under ideal circumstances (accurate knowledge of vehicle parameters, no measurement noise, no curvature estimation uncertainty), the closed-loop transfer function Tzd has an infinitely small DC gain; effectively the road disturbance can be completely rejected. In practice, despite parameter uncertainty and estimation error, adequate performance can still be maintained, which will be explored in the next section.
A simulation of lane keeping despite curvature disturbance was implemented first in Simulink. The linear model of combined vehicle and road dynamics in Eq. (9) was employed and the driver controller was parameterized as discussed in previous sections, with 0.2s time delay and 0.15s neuro-muscular lag. To test the robustness, it was assumed that the curvature perceived by the driver was only 80% of the true value. No driver remnant or measurement noise was included. The simulated road track consisted of a circular arc with two straight segments appended on both ends. The curvature was chosen to induce a 0.25 g lateral acceleration at steady-state curve negotiation.
Figure 10 presents the closed-loop responses and driver inputs at u0 = 25 m/s. The abrupt transitions between straight and circular segments result in step changes in road curvature at simulation moments 2s and 15s. In the subpanels, the dashed lines denote the theoretical values of steering wheel angle, yaw rate, lateral acceleration, heading angle, and preview point displacement respectively, if the vehicle is to track the circular curve perfectly.
Figure 10 demonstrates that despite curvature estimation inaccuracy, the lane-keeping task can be accomplished successfully despite estimation errors. The steady-state values of the solid lines converge to the theoretical levels marked by dashed lines. The transient phase is brief and without much oscillation. In the topmost subpanel, the total steering wheel angle is consistent with the theoretical computation. Although the feedforward part does not perform well due to the estimation inaccuracy imposed by us, the remaining deviation is nulled by the feedback part. Eventually YCG at steady state is nonzero, but almost negligible. During the transience YCG is within the limits of 0.9 m, and no lane exceedance occurs.
Then simulations based on a nonlinear vehicle model were conducted by using the CarSim software from the Mechanical Simulation Corporation [21]. CarSim simulates and analyzes the dynamic behavior of light vehicles on 3-D road surfaces. It is capable of predicting 3D forces and vehicle motions in response to driver inputs such as steering, throttling, and braking. CarSim also generates a great number of output variables for visualization and analysis, and allows an interactive animation of simulated tests.
Figure 11. A serpentine roadway geometry, also used in [6] and [22].
Vehicle parameters were specified in CarSim, especially tire characteristics. Comparison tests were run to verify responses from the 2-DOF model and CarSimr model against field experiments [23]. The driver steering module, implemented in Simulink blocks, was interfaced with CarSim to provide lateral directional control. A serpentine roadway (Figure 11) with an approximate total length of 2000 m was constructed in CarSim (also used in [6] and [22]). Within the CarSim environment, the upcoming road curvature will not be provided directly to the driver module. Instead, it is assumed that the driver retrieves the coordinates of five points on the road centerline within preview distance, performs a circle fitting by least squares [24], and derives the corresponding road curvature for feedforward control. Figure 12 shows time histories of estimated curvature, CG lateral position, steering wheel angle, and lateral acceleration at a cruising speed of 50 km/h (13.9 m/s). The control parameters are determined for this velocity as discussed before and adequate performance is attained. Except at locations with large and fast-changing curvatures, the lateral displacement can be well maintained close to the lane center. No lane excursion occurs. Qualitatively the pattern of the steering wheel angle bears a close resemblance with the simulator results in [6].
Although human characteristics are clearly nonlinear, linear analysis can still provide significant insights into human behavior. Motivated by human perception of upcoming road geometry and vehicle states, an effective albeit simplistic approach is proposed to analyze driver lane keeping control. The driver is assumed to look ahead and make use of future road curvature and lateral deviation of an "aim point" to adjust the steering wheel angle. The control system structure is established on linearized curve negotiation dynamics, and only two control parameters remain to be tuned. The resulting driver controller reflects the characteristics of human operators.
Satisfactory system performance is validated in realistic nonlinear simulation environment. Moreover, the proposed feedforward/feedback control structure can potentially be implemented for automatic lane-tracking if road preview information is made available by machine vision [23] or magnetic markers [25]. However, practical constraints, such as sensor noises, measurement or estimation accuracy, and bandwidth limitations of the steering actuator dynamics, need to be carefully addressed to maintain consistent and robust performance. Naturalistic driver lane keeping models can also be developed from this template if the necessary measurements are available.
