{"title":"Multi-Dimensional Analysis","markdown":{"headingText":"Multi-Dimensional Analysis","containsRefs":false,"markdown":"\n\nMulti-Dimensional Analysis (MDA) is a process made up of 4 main steps:\n\n1. Identification of relevant variables\n2. Extraction of factors from variables\n3. Functional interpretation of factors as dimensions\n4. Placement of categories on the dimensions\n\nIt is also a specific application of factor analysis. Factor analysis is a method(s) for reducing complexity in linguistic data, which can identify underlying principles of systematic variation [@biber1988variation].\n\n```{r setup, message = FALSE, error=FALSE, warning=FALSE}\nlibrary(tidyverse)\nlibrary(quanteda)\nlibrary(nFactors)\nlibrary(gt)\n```\n\nLoad functions:\n\n```{r}\nsource(\"../R/mda_functions.R\")\n```\n\n## Case 1: Biber Tagger\n\nIn order to carry out MDA, we would like to have 5 times as many observations than variables. This generally precludes carrying out MDA (or factor analysis) with simple word counts. We need data that has, in some way, been tagged.\n\nFor this lab, we will use data prepared using the R package **pseudobibeR**, which emulates the classification system that Biber has used and reported in much of his research. The package aggregates the lexicogrammatical and functional features widely used for text-type, register, and genre classification tasks.\n\nThe scripts are not really taggers. Rather, they use **udpipe** or **spaCy** part-of-speech tagging and dependency parsing to summarize patterns. They organize 67 categories that are described here:\n\n<https://cmu-textstat-docs.readthedocs.io/en/latest/pseudobibeR/pseudobibeR.html>\n\nFor this lab, you won't need to use the package functions. But if you'd like to try it out for any of your projects, you can follow the instructions here:\n\n<https://cmu-textstat-docs.readthedocs.io/en/latest/pseudobibeR/pseudobibeR.html>\n\n### The Brown Corpus\n\nLet's start with counts from the Brown Corpus. The Brown family of corpora is discussed on pg. 16 of Brezina. You can also find more about it here:\n\n<http://icame.uib.no/brown/bcm.html>\n\n```{r, warning=FALSE, message=FALSE}\nbc <- read_csv(\"https://raw.githubusercontent.com/browndw/cmu-textstat-docs/main/docs/_static/labs_files/data-csv/bc_biber.csv\", show_col_types = FALSE)\n\nbc_meta <- read_csv(\"https://raw.githubusercontent.com/browndw/cmu-textstat-docs/main/docs/_static/labs_files/data-csv/brown_meta.csv\", show_col_types = FALSE)\n```\n\nWe will join the data with the metadata, in order to calculate dimension scores by register and evaluate them. Note that it **must** be formatted as a factor. For convenience sake, we'll move the file names to the row names and put our factor as the first column.\n\n```{r}\n#| warning: false\n#| message: false\n\nbc <- bc %>%\n  left_join(dplyr::select(bc_meta, doc_id, text_type)) %>%\n  mutate(text_type = as.factor(text_type)) %>%\n  column_to_rownames(\"doc_id\") %>%\n  dplyr::select(text_type, everything())\n```\n\n### Correlation matrix\n\nBefore calculating our factors, let's check a correlation matrix. Note that we're dropping the first (factor) column.\n\n```{r}\nbc_cor <- cor(bc[-1], method = \"pearson\")\n```\n\n```{r}\n#| fig-width: 7\n#| fig-height: 7\n#| fig-cap: \"Correlation matrix of lexico-grammatical categories.\"\n\ncorrplot::corrplot(bc_cor, type = \"upper\", order = \"hclust\", \n         tl.col = \"black\", tl.srt = 45, diag = F, tl.cex = 0.5)\n```\n\n### Determining number of factors\n\nTypically, the number of factors is chosen after inspecting a scree plot.\n\n```{r}\n#| fig-width: 7\n#| fig-height: 3.5\n#| fig-cap: \"Scree plot of factors.\"\n\nscreeplot_mda(bc)\n```\n\nA common method for interpreting a scree plot is to look for the \"bend\" in the elbow, which would be 3 or 4 factors in this case. We can also look at the results of other kinds of solutions like optimal coordinates, which measures the gradients associated with eigenvalues and their preceding coordinates, and acceleration factor, which determines the coordinate where the slope of the curve changes most abruptly. In this case OC suggests 6 factors and AF 1.\n\nFor the purposes of this exercise, we'll start with 3 factors.\n\n### Calculating factor loadings and MDA scores\n\nIn factor analysis factors so that they pass through the middle of the relevant variables. For linguistic variable it is conventional to use a promax rotation (see Brezina pgs. 164-167). There is also a nice explanation of rotations here:\n\n<https://personal.utdallas.edu/~herve/Abdi-rotations-pretty.pdf>\n\nTo place our categories along the dimensions, data is standardized by converting to z-scores. For each text,  a dimension score is calculated by summing all of the high-positive variables subtracting all of the high-negative variables. Then, the mean is calculated for each category.\n\nFor these calculations, we will use the `mda_loadings()` function.\n\n```{r}\nbc_mda <- mda_loadings(bc, n_factors = 3)\n```\n\nWe can access factor loadings and group means through attributes.\n\n```{r}\n#| tbl-cap: \"Factor loadings for the Brown Corpus.\"\n\nattr(bc_mda, 'loadings')|>\n  rownames_to_column(\"Feature\") |>\n  gt() |> \n  fmt_number(\n    columns = everything(),\n    decimals = 2\n  ) |>\n  as_raw_html()\n```\n\n### Plotting the results\n\nThe means are conventionally positioned on a stick plot of the kind Brezina shows on pg. 169.\n\n```{r}\n#| fig-width: 7\n#| fig-height: 4.5\n#| fig-cap: \"Dimension score means by discipline plotted along Factor 1.\"\n\n\nstickplot_mda(bc_mda, n_factor = 1)\n```\n\nWe can also show the same plot with the factor loadings. \n\n```{r}\n#| warning: false\n#| fig-width: 7\n#| fig-height: 5.5\n#| fig-cap: \"Dimension score means by discipline plotted along Factor 1.\"\n\nheatmap_mda(bc_mda, n_factor = 1)\n```\n\n### Evaluating MDA\n\nTypically, MDA is evaluated using ANOVA, reporting the *F* statistic, degrees of freedom, and R-squared. We can extract that information from a linear model.\n\n```{r}\nf_aov <- aov(Factor1 ~ group, data = bc_mda)\nbroom::tidy(f_aov)\n```\n\n\n```{r}\ngtsummary::tbl_regression(lm(Factor1 ~ group, data = bc_mda)) |>\n  gtsummary::add_glance_source_note() |>\n  gtsummary::as_gt() |>\n  as_raw_html()\n```\n\n```{r}\ngtsummary::tbl_regression(lm(Factor2 ~ group, data = bc_mda)) |>\n  gtsummary::add_glance_source_note() |>\n  gtsummary::as_gt() |>\n  as_raw_html()\n```\n\n```{r}\ngtsummary::tbl_regression(lm(Factor3 ~ group, data = bc_mda)) |>\n  gtsummary::add_glance_source_note() |>\n  gtsummary::as_gt() |>\n  as_raw_html()\n```\n\n___\n\\begin{center}\nSTOP!\\\\\nCOMPLETE TASK 1\n\\end{center} \n___\n\n## Case 2: DocuScope\n\nUnlike the Biber tagger, DocuScope is a dictionary based tagger. It has been developed at CMU by David Kaufer and Suguru Ishizaki since the early 2000s. A small version of it is on Canvas, which you can download. You can find the dictionary categories described here:\n\n<https://docuscospacy.readthedocs.io/en/latest/docuscope.html#categories>\n\n### Load the dictionary\n\n```{r}\nload(\"../data/ds_dict.rda\")\nload(\"../data/micusp_mini.rda\")\n```\n\nDocuScope is a very large dictionary (or lexicon) that organizes tens of millions of words and phrases into rhetorically oriented categories. It has some overlap with a few Biber's functional categories (like hedges), but is fundamentally different, as it isn't bases on parts-of-speech.\n\nThe **ds_dict** is a small quanteda dictionary that organizes a smaller set of words of phrases (tens of thousands rather than tens of millions). Here is a sample from 3 of the categories:\n\n```{r}\nds_dict[1:3]\n```\n\n\n### Tokenize the corpus\n\nAgain, we will use the **micusp_mini*, and we'll begin by tokenizing the data. Note that we're retaining as much of the original data as possible including punctuation. This is because our dictionary includes punctuation marks in it's entries.\n\n```{r}\nmicusp_tokens <- micusp_mini %>%\n  corpus() %>%\n  tokens(remove_punct = F, remove_numbers = F, remove_symbols = F, what = \"word\")\n```\n\nNext, we will use the **tokens_lookup()** function to count and categorize our features.\n\n```{r}\nds_counts <- micusp_tokens %>%\n  tokens_lookup(dictionary = ds_dict, levels = 1, valuetype = \"fixed\") %>%\n  dfm() %>%\n  convert(to = \"data.frame\") %>%\n  as_tibble()\n```\n\nFinally, we need to normalize the counts. Because DocuScope is not categorizing ALL of our tokens, we need a total count from the original tokens object.\n\n```{r}\ntot_counts <- quanteda::ntoken(micusp_tokens) %>%\n  data.frame(tot_counts = .) %>%\n  tibble::rownames_to_column(\"doc_id\") %>%\n  dplyr::as_tibble()\n\nds_counts <- dplyr::full_join(ds_counts, tot_counts, by = \"doc_id\")\n\n```\n\nNow we can normalize by the total counts before preparing the data for factor analysis.\n\n```{r}\nds_counts <- ds_counts %>%\n  dplyr::mutate_if(is.numeric, list(~./tot_counts), na.rm = TRUE) %>%\n  dplyr::mutate_if(is.numeric, list(~.*100), na.rm = TRUE) %>%\n  dplyr::select(-tot_counts)\n\nds_counts <- ds_counts %>%\n  mutate(text_type = str_extract(doc_id, \"^[A-Z]+\")) %>%\n  mutate(text_type = as.factor(text_type)) %>%\n  column_to_rownames(\"doc_id\")\n\n```\n\n### Calculating factor loadings and MDA score\n\nAgain, we will use 3 factors.\n\n```{r}\nmicusp_mda <- mda_loadings(ds_counts, n_factors = 3)\n```\n\n### Evaluating MDA\n\nWe can again check to see how explanatory our dimensions are.\n\n```{r}\ngtsummary::tbl_regression(lm(Factor1 ~ group, data = micusp_mda)) |>\n  gtsummary::add_glance_source_note() |>\n  gtsummary::as_gt() |>\n  as_raw_html()\n```\n\n```{r}\ngtsummary::tbl_regression(lm(Factor2 ~ group, data = micusp_mda)) |>\n  gtsummary::add_glance_source_note() |>\n  gtsummary::as_gt() |>\n  as_raw_html()\n```\n\n```{r}\ngtsummary::tbl_regression(lm(Factor3 ~ group, data = micusp_mda)) |>\n  gtsummary::add_glance_source_note() |>\n  gtsummary::as_gt() |>\n  as_raw_html()\n```\n\n### Plotting the results\n\nAnd we can plot the first factor.\n\n```{r}\n#| warning: false\n#| fig-width: 7\n#| fig-height: 5.5\n#| fig-cap: \"Dimension score means by discipline plotted along Factor 1.\"\n\nheatmap_mda(micusp_mda, n_factor = 1)\n```\n\n### Interpreting the factors as dimensions\n\nThe functional interpretation of factors as dimensions (Brezina pgs. 167-168) is probably the most challenging part of MDA. As analysts, we need to make sense out of why features (whether parts-of-speech, rhetorical categories, or other measures) are grouping together and contributing to the patterns of variation evident in products of the analysis.\n\nThat interpretation usually involves giving names to the dimensions based on their constituent structures. In Biber’s original study, he called his first, most explanatory dimension Involved vs. Informational Production. At the positive (Involved) end of the dimension are telephone and face-to-face conversations. At the negative (Information) end are official documents and academic prose.\n\nFeatures with high positive loadings include private verbs (like *think*), contractions, and first and second person pronouns. Features with high negative loadings include nouns and propositional phrases. Biber concludes that these patterns reflect the communicative purposes of the registers. Ones that are more interactive and affective vs. others that are more instructive and informative.\n\nIn order to understand how certain features are functioning, it is important to see how they are being used, which we can do effienciently with Key Words in Context (KWIC). Here we take \"Confidence High\" from the positive end of the dimension and \"Academic Writing Moves\" from the negative.\n\n```{r kwic}\nch <- kwic(micusp_tokens, ds_dict[\"ConfidenceHigh\"])\n\nawm <- kwic(micusp_tokens, ds_dict[\"AcademicWritingMoves\"])\n```\n\n\n```{r}\n#| code-fold: true\n\nch |>\n  head(10) |>\n  gt() |>\n  as_raw_html()\n```\n\n\n```{r}\n#| code-fold: true\n\nawm |>\n  head(10) |>\n  gt() |>\n  as_raw_html()\n```\n\n\\break\n___\n\\begin{center}\nSTOP!\\\\\nCOMPLETE TASK 2\n\\end{center} \n___\n\n## Works cited\n\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"multi-dimensional-analysis.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.549","editor":"source"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":[]}